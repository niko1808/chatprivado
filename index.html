<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Chat Privado üí¨</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">

  <!-- Modal simple -->
  <style>
.modal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.65);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}

.modal.show {
  display: flex;
}

/* Caja del modal */
.modal-box {
  background: #111;
  color: #fff;

  width: 90%;
  max-width: 420px;

  max-height: 85vh;        /* CLAVE */
  overflow-y: auto;        /* CLAVE */

  padding: 20px;
  border-radius: 14px;
  text-align: left;

  box-shadow: 0 20px 50px rgba(0,0,0,.7);
}

/* T√≠tulo */
.modal-box h2 {
  margin: 0 0 12px;
  text-align: center;
  font-size: 20px;
}

/* Texto */
.modal-box p {
  font-size: 14px;
  line-height: 1.55;
  opacity: .9;
}

/* C√≥digo */
.modal-box code {
  display: block;
  background: #1e1e1e;
  padding: 10px;
  margin: 10px 0;
  border-radius: 8px;
  font-size: 13px;
  user-select: all;
  word-break: break-all;
}

/* Bot√≥n */
.modal-box button {
  margin-top: 14px;
  width: 100%;
  padding: 10px;
  border-radius: 8px;
  border: none;
  font-weight: 600;
  cursor: pointer;
}

/* Scrollbar */
.modal-box::-webkit-scrollbar {
  width: 8px;
}

.modal-box::-webkit-scrollbar-track {
  background: #1a1a1a;
  border-radius: 10px;
}

.modal-box::-webkit-scrollbar-thumb {
  background: #444;
  border-radius: 10px;
}

.modal-box::-webkit-scrollbar-thumb:hover {
  background: #666;
}

/* Pantallas chicas */
@media (max-height: 600px) {
  .modal-box {
    max-height: 90vh;
  }
}

    .donate-btn {
  margin-left: auto;
  padding: 4px 10px;          /* üëà m√°s angosto */
  font-size: 13px;
  height: 28px;
  line-height: 1;
  background: #0f172a;
  color: #22c55e;
  font-weight: bold;
  border-radius: 8px;
  border: 1px solid #22c55e;
  cursor: pointer;
  position: relative;
  z-index: 1;
  overflow: hidden;
}

/* Halo neon */
.donate-btn::before {
  content: "";
  position: absolute;
  inset: -2px;
  border-radius: 10px;
  background: linear-gradient(
    90deg,
    #22c55e,
    #4ade80,
    #22c55e
  );
  opacity: 0.7;
  filter: blur(6px);
  z-index: -1;
  animation: neonPulse 2.5s linear infinite;
}

/* Animaci√≥n neon */
@keyframes neonPulse {
  0% {
    filter: blur(4px);
    opacity: 0.2;
  }
  50% {
    filter: blur(8px);
    opacity: 0.5;
  }
  100% {
    filter: blur(4px);
    opacity: 0.2;
  }
}

/* Hover */
.donate-btn:hover {
  color: #a7f3d0;
  border-color: #4ade80;
}

  </style>

<!-- ================= MODAL LEGAL ================= -->
<div class="modal show" id="legalModal">
  <div class="modal-box">
    <h2>üìú Aviso legal y condiciones de uso</h2>

    <p style="font-size:14px;line-height:1.5">
      Este software permite el intercambio de mensajes privados entre usuarios
      mediante salas temporales protegidas por un c√≥digo.
      <br><br>

      El autor y desarrollador, <strong>Rodrigo Nicol√°s Mercado</strong>, 
      <strong>NO</strong> se responsabiliza por el uso indebido, ilegal,
      malicioso o contrario a la ley que cualquier usuario haga de la aplicaci√≥n.
      <br><br>

      El usuario es el √∫nico y exclusivo responsable del contenido que env√≠a,
      recibe o comparte, incluyendo (pero no limitado a) mensajes, enlaces,
      im√°genes, archivos o cualquier otro tipo de informaci√≥n.
      <br><br>

      Esta aplicaci√≥n <strong>NO</strong> promueve ni tolera:
      <ul style="margin:6px 0 6px 16px">
        <li>Actividades ilegales</li>
        <li>Acoso, amenazas o violencia</li>
        <li>Difusi√≥n de contenido ilegal o sensible</li>
        <li>Suplantaci√≥n de identidad</li>
        <li>Uso para fines delictivos</li>
      </ul>

      El desarrollador no tiene control sobre las conversaciones privadas ni
      sobre el comportamiento de los usuarios, y no ser√° responsable por da√±os,
      perjuicios, conflictos legales o consecuencias derivadas del uso de la app.
    </p>

    <hr style="margin:12px 0">

    <p style="font-size:14px;line-height:1.5">
      <strong>Funcionamiento de la aplicaci√≥n:</strong><br>
      ‚Ä¢ Una persona crea una sala privada.<br>
      ‚Ä¢ El sistema genera un <strong>c√≥digo de 6 d√≠gitos</strong>.<br>
      ‚Ä¢ Ese c√≥digo se comparte con otra persona.<br>
      ‚Ä¢ El receptor puede:
      <ul style="margin:6px 0 6px 16px">
        <li>Pegar el c√≥digo autom√°ticamente</li>
        <li>O escribirlo manualmente y presionar <strong>Conectar</strong></li>
      </ul>
      ‚Ä¢ Al conectar, ambos usuarios ingresan a un <strong>chat privado</strong>.
    </p>

    <hr style="margin:12px 0">

    <p style="font-size:14px;line-height:1.5">
      <strong>Financiamiento y donaciones:</strong><br>
      Esta aplicaci√≥n se mantiene activa gracias a <strong>donaciones an√≥nimas</strong>.
      No existe obligaci√≥n alguna de donar, pero cualquier aporte ayuda a
      sostener el desarrollo, el mantenimiento y la mejora continua del sistema.
      <br><br>
      Si la aplicaci√≥n te resulta √∫til, consider√° colaborar üíô.
      <br><br>
      <strong>¬°Gracias por apoyar el proyecto!</strong>
    </p>

    <label style="display:block;margin-top:12px;font-size:13px">
      <input type="checkbox" id="legalCheck">
      He le√≠do, entendido y acepto todas las condiciones. Asumo total responsabilidad por el uso que haga de la aplicaci√≥n.
    </label>

    <button id="legalAccept" style="margin-top:14px" disabled>
      Aceptar y continuar
    </button>
  </div>
</div>


<!-- ================= INPUT IMAGEN ================= -->
<input type="file" id="imgInput" accept="image/*" hidden>

<script>
/* ===== MODAL LEGAL ===== */
(function(){
  const modal = document.getElementById("legalModal");
  const check = document.getElementById("legalCheck");
  const btn = document.getElementById("legalAccept");
/*
  if (localStorage.getItem("legalAccepted")==="true") {
    modal.classList.remove("show");
    return;
  }
*/
  document.body.style.overflow="hidden";
  check.onchange = ()=> btn.disabled = !check.checked;
  btn.onclick = ()=>{
  modal.classList.remove("show");
  document.body.style.overflow="";
};
})();
</script>

</head>
<body>

<div class="phone">

  <header style="display:flex;align-items:center;gap:10px">
    <div class="avatar big"></div>
    <div style="flex:1">
      <h1 style="display:flex;align-items:center;gap:10px">
        Chat Privado
        <button id="donateBtn" class="donate-btn">‚ù§Ô∏è Donar</button>
      </h1>
      <span id="status">üî¥ No conectado</span>
    </div>
  </header>

  <div class="controls">
    <button id="create">Crear chat</button>
    <button id="copy" disabled>üìã Copiar c√≥digo</button>
    <button id="destroy" disabled>üóëÔ∏è Eliminar chat</button>
  </div>

  <div class="join-box">
    <input id="joinInput" placeholder="Peg√° c√≥digo de 6 d√≠gitos">
    <button id="pasteBtn">üìã Pegar</button>
    <button id="joinBtn">Conectar</button>
  </div>

  <div class="link-box" id="linkBox" hidden>
    <input id="roomLink" readonly>
  </div>

  <div id="messages" class="messages"></div>

  <div class="input">
    <input id="messageInput" placeholder="Mensaje..." disabled>
    <button id="send" disabled>‚û§</button>
  </div>

</div>

<!-- MODAL DONACIONES -->
<div class="modal" id="donateModal">
  <div class="modal-box">
    <h2>‚ù§Ô∏è Apoy√° este proyecto</h2>
    <p>
      Este chat privado se mantiene gracias a donaciones an√≥nimas.
      Tu aporte ayuda a pagar infraestructura, mantener el servicio
      y seguir mejor√°ndolo.
    </p>

    <p><strong>Datos para donar:</strong></p>

    <code>
      Alias: axnsoft.corp<br>
      Titular: Rodrigo Nicolas Mercado<br>
      Banco: Mercado Pago
    </code>

    <p>Las donaciones son totalmente voluntarias y an√≥nimas.</p>

    <button id="closeDonate">Cerrar</button>
  </div>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script src="firebase.js"></script>
<script src="chat.js"></script>

<script>
  const donateBtn = document.getElementById("donateBtn");
  const donateModal = document.getElementById("donateModal");
  const closeDonate = document.getElementById("closeDonate");

  donateBtn.onclick = () => donateModal.classList.add("show");
  closeDonate.onclick = () => donateModal.classList.remove("show");
  donateModal.onclick = e => {
    if (e.target === donateModal) donateModal.classList.remove("show");
  };
</script>

</body>
</html>
